# extension

## Autorize - to find a broken access control

дополнительный уровень защиты - соль == до процесса хэширования добавляется рандомная последовательность символов

a zero exit status signifies success, whereas any non-zero exit status is a failure.

    0: stdin
    1: stdout
    2: stderr

### network
как ходят пакеты

### network attacks

    port scanning
    denial of service
    buffer overflow
    man-in-the-middle - via weak security protocols - relay or proxy, manipulate data in real-time transacrions
    unauthorized access - weak accaunt password protection, unencrypted network -> least priveleges
    IP spoofing -> An intruder can also create IP packets from valid addresses in the corporate intranet using specific programs.

### firewall ==> stateful stateless

    firewall -> for monitoring all incoming and outgoing traffic. Protects network system from any network-based security threat.

    каждую сессию записывают в таблицу соединений 

    синхронизация стайтов

    по пакетам или по сессиям - stateless stateful

    5 - tuple hash == src ip, src port, proto, dst ip, dst port (кортеж из 5 элементов)

### dump traffic

#### web-check

### безопасность ОС - где журналы

#### windows

    пароли не соленые 

#### linux

    нельзя сделать доступ толлько на запись в файле

    программы наследуют права пользователя

    есть дополнительные биты доступа

    ACL - гранилированно выставлять права

    DAC - дискретная модель доступа

    протоколирование событий

    Capabilities

    authentication - идентификация всех пользователей и запущенных от их имени программ

    Unauthorized reading of data
    Unauthorized modification of data
    Unauthorized destruction of data

    Linux has a far more robust permissions system preventing unauthorized access to files. Furthermore, rule-based security features – such as SELinux – prevent potentially malicious programs from reading, writing, and executing files.

Security-Enhanced Linux (SELinux) is a security architecture for Linux® systems that allows administrators to have more control over who can access the system.

An operating system is the software that directly manages a system’s hardware and resources, like CPU, memory, and storage. The OS sits between applications and hardware and makes the connections between all of your software and the physical resources that do the work.

    Операционная система — это программное обеспечение, которое напрямую управляет аппаратным обеспечением и ресурсами системы, такими как ЦП, память и хранилище. ОС находится между приложениями и оборудованием и обеспечивает связь между всем вашим программным обеспечением и физическими ресурсами, которые выполняют работу.

Every Linux-based OS involves the Linux kernel—which manages hardware resources—and a set of software packages that make up the rest of the operating system.
    
    Каждая ОС на основе Linux включает в себя ядро Linux, которое управляет аппаратными ресурсами, и набор программных пакетов, составляющих остальную часть операционной системы.

### User Accounts

### File Permissions

owner group all other
read write execute

### encrypted storage

### secure remote access

### software management

### application control

### monitoring and loging

### system firewall netfilter

## windows

    secure boot and trusted boot

MICROSOFT DEFENDER

### linux logs

    Application Logs
    Event Logs
    Service Logs
    System Logs

    0-7 level

/var/log/

### windows logs

    Application – Information logged by applications hosted on the local machine.
    Security – Information related to login attempts (success and failure), elevated privileges, and other audited events.
    Setup – Messages generated when installing and upgrading the Windows operating system. If the Windows system is a domain controller, those messages are also logged here.
    System – Messages generated by the Windows operating system.

    Information
    Warning
    Error
    Critical
    Audit success
    Audit failure

    IIS

    %SystemDrive%\inetpub\logs\LogFiles
    C:\inetpub\logs\LogFiles\

### MacOS

System Integrity Protection is a security technology designed to help prevent potentially malicious software from modifying protected files and folders on your Mac. System Integrity Protection restricts the root user account and limits the actions that the root user can perform on protected parts of the Mac operating system.

    System Integrity Protection — это технология безопасности, предназначенная для предотвращения изменения защищенных файлов и папок на вашем Mac потенциально вредоносным программным обеспечением. Защита целостности системы ограничивает учетную запись пользователя root и ограничивает действия, которые пользователь root может выполнять в защищенных частях операционной системы Mac.


QoS - позволяет приоритизировать разные типы трафика 
анализ заголовков
longest prefix match
найти исходящий интерфейс
всегда будет меняться ehternet заголовок, т.к. будут меняться маки
нужно пересчитать контрольную сумму
на каждом сетевом устройстве есть буферная память в которой храниться имформвция об обработке пакета

retransmit  вдвух случаях - когда пакет не дошел до получателя и когда ACK от получателя не дошел к отправителю за RTT (истечение времени ожидания)

TCP incast

NS3 - для тестирования
Tail Drop - все дропается 
Random Drop 

### netcat

позволяет открыть сочет и писать в него или читать через него

```bash
nc -z -v -w 1 linkmeup.ru 443
```

-z только установить соединение без передачи данных
-v be verbose
-w X - timeout through X sec (-G1 on Mac)
-p X - src port number

```bash
for i in {1..10}; do nc -z -G1 -v linkmeup.ru 443 &>/dev/null && echo -n '!' || echo -n '.'; sleep 1; done
```

echo -n - каретка отсается в этой же строке

```bash
for i in {1024..65535}; do echo -n "$i: "; nc -z -G1 -p $i -v linkmeup.ru 443 &>/dev/null && echo 'Ok' || echo 'NOK'; sleep 1; done
```

### scapy

```bash
from scapy.all import *
ip_layer = IP(dst='185.12.23.12')
tcp_layer = TCP(sport=5555, dport=443, flags='S', seq=1000)
packet = ip_layer /tcp_layer
send(packt)
```

### mtr

```bash
mtr 1.1.1.1
mtr -T 1.1.1.1
mtr -U 1.1.1.1
```

Разграничение доступа к файлам по владельцу группам и тд

Разграничить уровни доступа

DAC - Discretionare Access Control

    работает только с файлами
    пространство ядра
    пространство пользователя

MAC - Mandatory Access Control

ACL - access control list

---

мы можем делить процессорное время между программами

OS - программа, которая может запускать другие программы и может управлять пользователями

    пространство ядра
    пространство пользователя
    есть ядро и есть все остальное
    мы работаем не с ОС, а с программами ОС
    есть программы которые там будут всегда

    ядро - центральная часть ОС, которая отвечает за взаимодействие программ с оборудованием

Windows and Linux - separate concept

в linux нет понятия дисков, все находиться в root '/'

в Linux команжы практически идентичны но настройки отличаются - например разный путь к файлам конфигурации, разные менеджеры пакетов (варианты устоновки ПО)

командная оболочка (bash) -  принимает команды пользователя и переводит их на язык понятный ядру

все зранится в корневом каталоге

Установка пакетов в Linux - это сохранение фалов

пакет - это архив с ПО

Log - журнал событий

демон - stdout and stderr направлен в сокет который отвечет за перепанправление их в фал

###

    curl http://<ip_address> -H "Host: site.ru" --cookie "test=openssl rand -hex 4096" -v

###

фильтрация входящего трафика (egress traffic) - `uReverse Path Forwarding`

    - strict RPF (адрес источника не из сети порта)
    - loose RPF (ни на одном порту нет маршрута в сеть источника)

### IPSec

    на сетевом уровне
    целостность и конфиденциальность
    может только целостность

Security Assiciation

SA DB

    параметры
    как часто будем менять ключи
    что будем использовать для аутентификации (PSK, Cert)

SA в одном направлении
Два SA для двунаправленной связи

Security Policy Database 
    
    отбросить пакет
    принять пакет но не обрабатывать с помощью IPSec
    обрабатывать с помощью IPSec

IKE - Internet Key Exchange

    обмен ключами
    синхронизация ключами  

ISAKMP - Internet Security Association Key Management Protocol

## WiFi

WEP
WPA
WPA2
WPA3

### cybersecurity

Доверенные - это те кто имеют некий секрет, пароль. (802.1x)

    confidentiality
    integrity
    avalability

    vulnerability - сущность, которая может создать угроозу 
    threat - возможность эксплуатации уязвимости
    attack - действия, с помощью которых эксплуатируется уязвимость

    CVSS - проектирование, реализация, эксплуатация
    CWE 

Vectors:

    remote, local
    attacks on users
               application
               server's application
               protocol

Goals:
    
    получение доступа
    повыщение привилегий
    раскрытие инофрмации
    нарушение целостности
    снижение доступности

Прикладной -> BGP, DNS, HTTP, SNMP
Транспортный -> TCP, UDP
Сетевой -> IP, ICMP
Канальный -> ARP, STP, VLAN

ARP - нет аутентификации

перехват и модификация трафика

ARP Spoofing 
CAM Table
Arp tssble

Port security
Static ARP table
не использовать IPv4 - в IPv6 не используется ARP
шифрование

### STP - 802.1 d - STP

BPDU - приоритет Bridge ID: Priority+MAC

Злоумышленник смотрит какой приоритет у roota и рассылает свой Bridge ID меньший приоритет

## Network Layer

BGP -> долгие TCP сессии

TCP Window - количество данных которое сможет принять хост без подтверждения

Syn Flood --> Syn Cookies

Acknowlegment Number - это производная от src IP and Port

уменьшение таймаут, отбрасывание пакетов с win == 0

## SNMP

аутентификация открым текстом
футентификация не плэйн текстом

## NTLM

протокол аутентификации  
пароль не передается по сети
challenge-response

DC сродержит hash от пароля пользователя
отправляет какой то challenge (8 byte) 
пользователь вычисляет значение от hash своего пароля и этого челенджа и отправляет в DC

NTLM-hash c фиксированной солью - hash одного и тогоже пароля будет идентичен

Rainbow tabales

пароль не нужен нужен только hash

## SMB Server Message Block Protocol

request-response protocol

`SMB` is a client-server interaction protocol where clients request a file, and the server provides it to the client. It is now a Windows-based network that gives users to create, modify and delete the shared files, folders, printers within the network. SMB is an application layered protocol that uses TCP Port 445 to communicate.

`SMB` - is a request-response protocol
`SMB` - shares the files over a network to access them among the clients in an effective way.

`SMB3.0` Version was introduced in WINDOWS 8 Server and windows server 2012. It was introduced to improve the encryption level end to end.

## OSPF -> Open Shortest Path First

LSA - Link State Advertisement 

## Web

Server side - более приоритетные
Client side - компроментация одного пользователя

Server side

    логические (IDOR)
        отсутствие разграничений прав доступа
        функциональность
        логика работы
    ошибки эксплуатации

    ошибки реализации

сериализация - берем некий клас и представляем его в виде строки

процессы общаются с ядром с помощью системных вызовов

SELinux требует перезагрузки сервера при внесении изменений
